Olvida el observable y estudia y aplica http://shoesrb.com/manual/Rules.html


Apply Observable module as done in robot exercise. Empieza con clases nuevas!! Nuevo main pig_ecocity. Dialogos no voy a tener. Solo views.
El robot tiene observadores y el plateau es informado cuando un robot cambia su estado.
La order tiene observadores y la order_view es informada cuando una order cambia.
Necesito una order view y una orders view
Un dialogo no es una view. Los dialogos tienen observadores y las views son informadas de cambios/o eventos como apretar un boton en el dialog.
Las views pueden modificar los objetos

Implica que:
Cuando en el dialogo order_dialog apretamos "Crear comanda", llamamos a change y notify_observers(self):
# Calls update(order_dialog) in observers -> views
changed
notify_observers( self )

Esto es posible porque el dialogo tiene "include Observable" y "attr_reader :customer_name, :date, :products"
De esa forma, en la funcion update(order_dialog) de la order_view podria leer :customer_name, :date, :products o cualquier otro atributo que se desee.

//////////////////////////////

Continue with SubProductsDialog. How to extract information from there ...

Peso no es obligatorio para produtos con subproductos

Change OrderItem to have:

attr_reader :product  (product object with possible subproducts)
attr_reader :quantity
attr_reader :weight     (Change that weight is not mandatory for Products that have ProductItems)
attr_reader :observations
attr_reader :price  (the price is calculated in constructor cause the customer is passed there)
attr_reader :items (list of OrderSubItem objects)   Create the OrderSubItem class

And change to_s function from OrderItem to consider new items attr.

Then try to figure out some UI for selecting ProductItem from Products while creating an order

In order_dialog.rb, extend add_item_to_ordered_items( customer_name, product_name, quantity, weigh, gui_observations )
with another attribute which could be SubProductItems with quantity, weight and product attributes
i.e subproduct_items = [ { :weight => 0,5, :quantity => 1, :product => product_object_llom },
                         { :weight => 0,4, :quantity => 1, :product => product_object_carn_picada } ]

Refactor products_csv with smaller functions
En products view, display subproducts properly.
Cuando se crea una comanda y se selecciona un lote, dar opciones de subproductos.

Clean up code since it is starting to be ugly.

Refactor OrderDialog in smaller functions                                                   my_products
Rename OrderDialog to NewOrderDialog

save as/load comandes (orders) in csv para poder cargarlas si se desea. Cuidado que aqui el cerdo no puede con tantas comandas?

Generar factura e imprimir/guardar/escribir factura

Cada producto resta una parte del cerdo
    - Tabla producto / partes del cerdo
